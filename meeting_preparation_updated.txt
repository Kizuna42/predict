
## 1. プロジェクト全体像

### 目的
**空調システムの室内温度を高精度で予測し、効率的な空調制御を実現する**
- 各ゾーンの将来温度（5分後〜30分後）を予測

### 対象システム
- **12ゾーン**の空調システム（L系統[0,1,6,7]、M系統[2,3,8,9]、R系統[4,5,10,11]）
- **5つの予測ホライゾン**：5分後、10分後、15分後、20分後、30分後
- **時系列データ**：約119MBのAllDayData.csv（5分間隔サンプリング）

---

## 2. 予測モデルの仕組み

### 使用アルゴリズム
**LightGBM（勾配ブースティング）** + **物理法則ベースの特徴量エンジニアリング**

### 入力データ（特徴量）
#### A. センサーデータ
- **温度センサー**：`sens_temp_{zone}`（各ゾーンの現在温度）
- **湿度センサー**：`sens_humid_{zone}`（利用可能な場合）
- **平滑化処理**：`sens_temp_{zone}_smoothed_w{window}`（ノイズ除去済みの温度データ）

#### B. 空調制御データ
- **空調ON/OFF状態**：`AC_valid_{zone}`
- **冷暖房モード**：`AC_mode_{zone}`
- **設定温度**：`AC_set_{zone}`
- **サーモ状態**：`thermo_state_{zone}`（センサー温度と設定温度の差）

#### C. 環境データ
- **外気温**：`atmospheric temperature`
- **日射量**：`total solar radiation`

#### D. 物理ベース特徴量（自動生成）
- **温度変化率**：`temp_rate_{zone}`
- **設定温度との差**：`temp_diff_to_setpoint_{zone}`
- **外気温との温度差**：`temp_diff_to_outside_{zone}`
- **空調応答性**：`setpoint_response_{zone}`
- **空調温度相互作用**：`ac_temp_interaction_{zone}`

#### E. 未来情報（重要な特徴）
- **未来の空調制御状態**：`{feature}_future_{horizon}`（例：`AC_valid_{zone}_future_15`）
- **未来の環境データ**：`{feature}_future_{horizon}`（例：`atmospheric_temperature_future_15`）

#### F. 多項式特徴量
- 2次交互作用：`poly_{feature1}_{feature2}`（例：温度×湿度、空調状態×外気温）

#### G. 時間特徴量
- **時間**：`hour`

#### ※ 補足
- `{window}`: 平滑化ウィンドウサイズ
- `{horizon}`: 予測ホライゾン（5, 10, 15, 20, 30分）

---
### 出力結果
- **各ゾーンの予測温度**：指定した時間後の室温
- **予測精度指標**：RMSE（平均誤差）、R²（決定係数）
- **特徴量重要度**：どの要素が予測に重要かの分析

---

## 3. モデル性能

### 現在の精度（ゾーン1、15分後予測の例）
- **R² = 0.88**
- **RMSE = 0.84℃**（平均予測誤差が1℃未満）
- **MAE = 0.67℃**（平均絶対誤差）

### 特徴量重要度の分析結果
1. **未来の空調制御状態**：95.7%
2. **現在の温度センサー値**：4.3%
3. **その他の物理特徴量**：微小

- **テストデータでの性能**：トレーニングデータより良好（過学習なし）

---

## 4. 技術的特徴

### データ処理
- **欠損値処理**：前方・後方補間
- **外れ値除去**：300℃以上の異常値を自動除去
- **平滑化処理**：複数ウィンドウサイズでノイズ除去

### 特徴量エンジニアリング
- **物理法則ベース**：熱力学の原理に基づく特徴量生成
- **自動特徴選択**：LightGBMベースの重要度による選択
- **多項式特徴量**：非線形関係の自動検出

### モデル最適化
- **重み付き学習**：急激な温度変化に重点を置いた学習
- **交差検証**：時系列データに適した検証手法
- **ハイパーパラメータ調整**：物理モデルに適した設定

---

## 5. 成果物

### 予測モデル
- **12ゾーン × 5ホライゾン = 60個**の専用モデル
- **保存形式**：pickle形式で再利用可能
- **特徴量情報**：各モデルの使用特徴量リスト

### 可視化ツール
- **実測値vs予測値**：散布図による精度確認
- **時系列プロット**：時間軸での予測追跡
- **詳細分析**：日/時/週単位での詳細可視化
- **LAG依存度分析**：過去データへの依存度評価

### 分析レポート
- **特徴量重要度**：どの要素が重要かの定量分析
- **予測精度評価**：RMSE、MAE、R²による性能評価

---
